/*
 * This file was generated by the Gradle 'init' task.
 */

plugins {
    id 'c'
    id 'cvc4.java-application-conventions'
}

dependencies {
    // https://mvnrepository.com/artifact/org.apache.commons/commons-lang3
    // implementation group: 'org.apache.commons', name: 'commons-lang3', version: '3.11'
    testImplementation(platform('org.junit:junit-bom:5.7.1'))
    testImplementation('org.junit.jupiter:junit-jupiter')
}

test {
    useJUnitPlatform()
    testLogging {
        events "passed", "skipped", "failed"
    }
}

application {
    // Define the main class for the application.
    mainClass = 'Main'
}

jar {
    manifest {
        attributes('Main-Class': 'Main')
    }
    from {
        configurations.compile.collect { it.isDirectory() ? it : zipTree(it) }
        configurations.runtimeClasspath.collect { it.isDirectory() ? it : zipTree(it) }
    }
}

task copyLibraries(type: Copy) {
    from "src/main/java/jni/cmake-build-debug/libcvcJavaApi.so", "src/main/java/jni/install/lib/libcvc4.so", "src/main/java/jni/cmake-build-debug/libcvcJavaApi.dylib", "src/main/java/jni/cmake-build-debug/cvcJavaApi.dll", "src/main/java/jni/install/lib/libcvc4.dylib"
    into "src/main/resources"
}

compileJava.configure {mustRunAfter(copyLibraries)}
